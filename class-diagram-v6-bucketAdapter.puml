@startuml
title ETL Transform

class BucketService {
    + download(...)
    + upload(...)
}

class BucketAdapterFactory {
    + getBucketAdapter(): IBucketAdapter
}

interface IBucketAdapter {
    + upload(string: remote, object: byte[]): void
    + download(string: remote): byte[] 
}

class GCPBucketAdapterImpl
class AWSBucketAdapterImpl {
    - awsClient: IAWSClient
    + AWSBucketAdapterImpl(client: IAWSClient)
}

class TransformData {
    + transform(objects: byte[]): byte[]
}

' ---- SDK ----
package AWSSDK {
    interface IAWSClient
    class AWSClient
}

package GCPSDK {}

' ---- Relationships ----
BucketService --> BucketAdapterFactory
BucketAdapterFactory --> IBucketAdapter

IBucketAdapter <|.. AWSBucketAdapterImpl
IBucketAdapter <|.. GCPBucketAdapterImpl

' Dependency Injection instead of instantiation
AWSBucketAdapterImpl --> IAWSClient : uses
AWSClient ..|> IAWSClient

AWSBucketAdapterImpl ..> AWSSDK
GCPBucketAdapterImpl ..> GCPSDK

' ---- Test ----
class TestAWSBucketAdapterImpl {
    - mockAWSClient: IAWSClient
}

TestAWSBucketAdapterImpl --> AWSBucketAdapterImpl : injects
TestAWSBucketAdapterImpl --> IAWSClient : creates mock

@enduml
